# -*- coding: utf-8 -*-
"""internship project 1.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/101Dv8Uu4szwBRMdLV3QZ0m_OvM1Lr4bV

OBJECTIVE :
To predict the mileage of vehicles

Data Source: "https://github.com/YBI-Foundation/Dataset/raw/main/MPG.csv"
"""

#import library
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

#import data
Mil=pd.read_csv("https://github.com/YBI-Foundation/Dataset/raw/main/MPG.csv")
Mil.head()

Mil.columns

#remove missing values
Mil=Mil.dropna()

#describe data
Mil.info()

Mil.describe()

#data visualisation
sns.regplot(x='displacement',y='mpg',data=Mil)

#data preprocessing
Mil.info()

Mil.corr()

Mil.describe()

#define target variable y and feature x
Mil.columns

y=Mil['mpg']
x=Mil[['displacement', 'horsepower', 'weight',
       'acceleration']]

#train test split
from sklearn.model_selection import train_test_split
x_train, x_test, y_train, y_test = train_test_split(x,y, train_size=0.8, random_state=2)

x_train.shape, x_test.shape, y_train.shape, y_test.shape

#linear regression model
from sklearn.linear_model import LinearRegression
model=LinearRegression()

#modeling
model.fit(x_train,y_train)

model.coef_

model.intercept_

#Predict model
y_pred=model.predict(x_test)

y_pred

# model accuracy and evaluation
from sklearn.metrics import mean_absolute_percentage_error
mean_absolute_percentage_error(y_test,y_pred)
#hence model is 87% accurate

#we start by importing required libraries
#then we import the data required
#we then describe the data
#we then visualize and preprocess the data
#we then Define Target Variable (y) and Feature Variables (X)
#we then import the train test
#we use linear regression model
#we then evluate the model
#then we do a prediction of the linear regression model
#at last we check the accuracy of the model used
